# 海量数据处理

先计算一下海量数据需要占多大的空间。常见的单位换算如下：

- 1 byte = 8 bit
- 1 KB = 210 byte = 1024 byte ≈ 103 byte
- 1 MB = 220 byte ≈ 10 6 byte
- 1 GB = 230 byte ≈ 10 9 byte
- 1 亿 = 108

1 个整数占 4 byte，1 亿个整数占 4*108 byte ≈ 400 MB。



分治思想

可以将海量数据拆分到多台机器上、拆分到多个小文件上。



## 拆分

拆分方法：

1、按出现的顺序拆分：

当有新数据到达时，先放进当前机器，填满之后再将数据放到新增的机器上。

优点：充分利用系统的资源，因为每台机器都会尽可能被填满。

缺点：需要一个查找表来保存数据到机器的映射，查找表可能会非常复杂并且非常大。



2、按散列值拆分：

选取数据的主键 key，然后通过哈希取模 hash(key)%N 得到该数据应该拆分到的机器编号，其中 N 是机器的数量。

优点：

不需要使用查找表

缺点：

可能会导致一台机器存储的数据过多，甚至超出它的最大容量。



3、按数据的实际含义拆分：

例如一个社交网站系统，来自同一个地区的用户更有可能成为朋友，如果让同一个地区的用户尽可能存储在同一个机器上。

优点：在查找一个用户的好友信息时，就可以避免到多台机器上查找，从而降低延迟。

缺点：

同样是需要使用查找表。



## 整合

拆分之后的结果还只是局部结果，需要将局部结果汇总为整体的结果。

# 参考资料

- 程序员面试金典
- 程序员代码面试指南